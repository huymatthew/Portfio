{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'dictionary/css/search.css' %}">
{% endblock %}

{% block content %}
    <div style="height: 100px;"></div> 
    <section class="search-section">
        <div class="search-container">
            <div class="search-box">
                <input type="text" class="search-input" placeholder="T√¨m t·ª´ v·ª±ng..." value="{{ query }}" id="searchInput">
                <button class="search-btn" onclick="performSearch()">üîç T√¨m ki·∫øm</button>
            </div>
            <div class="search-info">
                Hi·ªÉn th·ªã {{ length }} t·ª´ v·ª±ng
            </div>
        </div>
    </section>

    <main class="results-container">
        <div class="results-header">
            <div class="results-count">
                T·ªïng c·ªông <strong>{{ length }}</strong> t·ª´ v·ª±ng trong b·ªô s∆∞u t·∫≠p
            </div>
        </div>

        <div class="results-list" id="resultsList">
            {% for item in vocabulary %}
            <div class="vocab-item">
                <div class="vocab-word">
                    {{ item.word }} <span class="vocab-phonetic">{{ item.phonetic }}</span>
                    <span class="vocab-type">{{ item.type }}</span>
                </div>
                <div class="vocab-meaning">
                    {{ item.meaning }}
                </div>
                <div class="vocab-meta">
                    <div class="vocab-level">
                        <span class="level-badge level-{{ item.level }}">{{ item.level|capfirst }}</span>
                    </div>
                    <div class="vocab-actions">
                        <button class="action-btn pronunciation-btn" onclick="playPronunciation('{{ item.word }}')" title="Ph√°t √¢m">üîä</button>
                        <button class="action-btn" onclick="toggleFavorite(this)" title="Y√™u th√≠ch">‚ù§Ô∏è</button>
                        <button class="action-btn" onclick="markAsLearned(this)" title="ƒê√£ h·ªçc">‚úì</button>
                    </div>
                </div>
            </div>

            {% endfor %}
        </div>

        <div class="pagination">
            <button class="page-btn" onclick="changePage(-1)" disabled>‚Üê Tr∆∞·ªõc</button>
            <button class="page-btn active" onclick="goToPage(1)">1</button>
            <button class="page-btn" onclick="goToPage(2)">2</button>
            <button class="page-btn" onclick="goToPage(3)">3</button>
            <button class="page-btn" onclick="goToPage(4)">4</button>
            <button class="page-btn" onclick="goToPage(5)">5</button>
            <span>...</span>
            <button class="page-btn" onclick="goToPage(20)">20</button>
            <button class="page-btn" onclick="changePage(1)">Ti·∫øp ‚Üí</button>
        </div>
    </main>
{% endblock %}

{% block extra_js %}
    <script>
        let currentPage = 1;
        let currentFilter = 'all';
        
        // M√¥ ph·ªèng d·ªØ li·ªáu t·ª´ v·ª±ng
        const vocabularyData = {
            all: [
                {% for word in vocabulary %}
                    {
                        word: "{{ word.word }}",
                        phonetic: "{{ word.phonetic }}",
                        type: "{{ word.type }}",
                        meaning: "{{ word.meaning }}",
                        example: "{{ word.example }}",
                        translation: "{{ word.translation }}",
                        level: "{{ word.level }}"
                    },
                {% endfor %}
            ],
            beginner: [],
            intermediate: [],
            advanced: [],
            favorite: []
        };
    </script>
    <script src="{% static 'dictionary/js/search.js' %}"></script>
    <script>
        displayVocabulary(vocabularyData.all);
        document.getElementById('searchInput').addEventListener('input', function() {
            performSearch();
        });
    </script>
{% endblock %}